<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>test-sinVite</title>
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC"
      crossorigin="anonymous"
    />
    <link rel="stylesheet" href="style.css" />
  </head>
  <body>
    <div class="container" id="app">
      <nav class="navbar navbar-expand-lg navbar-light bg-light">
        <div class="container-fluid">
          <a class="navbar-brand" href="#">Bsale</a>
          <button
            class="navbar-toggler"
            type="button"
            data-bs-toggle="collapse"
            data-bs-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent"
            aria-expanded="false"
            aria-label="Toggle navigation"
          >
            <span class="navbar-toggler-icon"></span>
          </button>
          <div class="navbar-nav ml-auto">
            <div class="collapse navbar-collapse" id="navbarSupportedContent">
              <form id="searchByQuery" class="d-flex">
                <input
                  class="form-control me-2"
                  type="search"
                  placeholder="Search"
                  aria-label="Search"
                  name="name"
                />
                <button class="btn btn-outline-success" type="submit">
                  Search
                </button>
              </form>
            </div>
          </div>
        </div>
      </nav>
      <!-- <div class="container">
        <div class="row row-cols-3">
          <div id="all-products" style="display: none"></div>
        </div>
      </div> -->
      <div class="container">
        <div class="row rows-cols-1 row-cols-md-3 g-3" id="all-products">
          <!-- <div id="all-products"></div> -->
        </div>
      </div>
    </div>
  </body>
  <script>
    // fetch("http://localhost:3001/api/products")
    //   .then((resp) => resp.json())
    //   .then((data) => {
    //     console.log(data);
    //     const html = data
    //       .map((product) => {
    //         return `
    //         <div class="col" id="test-col">
    //           <div class="card border-dark h-100" style="width: 18rem">
    //               <img
    //                 src="${product.url_image}"
    //                 class="card-img-top img-thumbnail"
    //                 alt="${product.name}"
    //               />
    //               <div class="card-body">
    //                 <h5 class="card-title">${product.name}</h5>
    //                 <p class="card-text">$${product.price}</p>
    //               </div>
    //           </div>
    //         </div>
    //         `;
    //       })
    //       .join("");
    //     document
    //       .querySelector("#all-products")
    //       .insertAdjacentHTML("afterend", html);
    //   });

    fetch("http://localhost:3001/api/products")
      .then((resp) => resp.json())
      .then((data) => {
        console.log(data);
        data.map((product) => {
          document.getElementById("all-products").innerHTML += `
            <div class="col" id="test-col">
              <div class="card border-dark h-100" style="width: 18rem">
                  <img
                    src="${product.url_image}"
                    class="card-img-top img-thumbnail"
                    alt="${product.name}"
                  />
                  <div class="card-body">
                    <h5 class="card-title">${product.name}</h5>
                    <p class="card-text">$${product.price}</p>
                  </div>
              </div>
            </div>
            `;
        });
      });

    // formulario
    let form = document.querySelector("#searchByQuery");
    form.addEventListener("submit", (e) => {
      e.preventDefault();
      console.log(form.querySelector('input[name="name"]'));
      const formData = new FormData(form);
      console.log(formData.get("name"));
      const dataName = formData.get("name");

      // fetch(`http://localhost:3001/api/products?name=${dataName}`)
      //   .then((resp) => resp.json())
      //   .then((data) => {
      //     console.log(data);
      //     const html = data
      //       .map((product) => {
      //         return `
      //       <div class="col">
      //         <div class="card border-dark h-100" style="width: 18rem">
      //             <img
      //               src="${product.url_image}"
      //               class="card-img-top img-thumbnail"
      //               alt="${product.name}"
      //             />
      //             <div class="card-body">
      //               <h5 class="card-title">${product.name}</h5>
      //               <p class="card-text">$${product.price}</p>
      //             </div>
      //         </div>
      //       </div>
      //       `;
      //       })
      //       .join("");
      //     document
      //       .querySelector("#all-products")
      //       .insertAdjacentHTML("afterend", html);
      //   });
      fetch(`http://localhost:3001/api/products?name=${dataName}`)
        .then((resp) => resp.json())
        .then((data) => {
          console.log(data);
          let searchProducts = "";
          data.map((product) => {
            searchProducts += `
          <div class="col" id="test-col">
              <div class="card border-dark h-100" style="width: 18rem">
                  <img
                    src="${product.url_image}"
                    class="card-img-top img-thumbnail"
                    alt="${product.name}"
                  />
                  <div class="card-body">
                    <h5 class="card-title">${product.name}</h5>
                    <p class="card-text">$${product.price}</p>
                  </div>
              </div>
            </div>
          `;
          });
          document.getElementById("all-products").innerHTML = searchProducts;
        });
    });
  </script>
</html>
